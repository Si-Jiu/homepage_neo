const fetchSteamStatsOri = async () => { try { document.getElementById("playingGame").textContent = "正在使用第三方API，无法获取正在游玩的游戏，并且有延迟", document.getElementById("playingGame").style = "font-size: 1vw;"; const e = "76561199446086078", t = await fetch(`https://uapis.cn/api/v1/game/steam/summary?steamid=${e}`), n = await t.json(); if (t.ok) { if (0 === (n?.personastate ?? "N/A")) { document.getElementById("steamOnline").textContent = "离线"; const e = window.matchMedia("(prefers-color-scheme: dark)"); document.getElementById("steamOnline").style = e ? "color:#ebebeb" : "color:#898989" } else document.getElementById("steamOnline").textContent = "在线", document.getElementById("steamOnline").style = "color:#57cbde" } else document.getElementById("steamOnline").textContent = "N/A", document.getElementById("steamOnline").style = "color:#FF0000" } catch (e) { document.getElementById("steamOnline").textContent = "Error", document.getElementById("steamOnline").style = "color:#FF0000", console.log(e) } }, fetchSteamStats = async () => { try { const e = "76561199446086078", t = await fetch(`https://ip.charliehome.xx.kg/api/steam/${e}`), n = await t.json(); if (!t.ok) return void fetchSteamStatsOri(); if (0 === (n?.response?.players[0]?.personastate ?? "N/A")) { document.getElementById("steamOnline").textContent = "离线"; const e = window.matchMedia("(prefers-color-scheme: dark)"); document.getElementById("steamOnline").style = e ? "color:#ebebeb" : "color:#898989" } else { const e = n?.response?.players[0]?.gameid ?? "N/A"; if ("N/A" === e) document.getElementById("steamOnline").textContent = "在线", document.getElementById("steamOnline").style = "color:#57cbde"; else { document.getElementById("steamOnline").textContent = "游戏中", document.getElementById("steamOnline").style = "color:#90ba3c"; const t = await fetch(`https://ip.charliehome.xx.kg/api/store/?appids=${e}`), n = await t.json(), o = n[e]?.data?.name ?? "N/A"; document.getElementById("playingGame").textContent = "正在游玩：" + o, document.getElementById("playingGame").setAttribute("href", `https://store.steampowered.com/app/${e}`) } } } catch (e) { return fetchSteamStatsOri(), void console.log(e) } }; fetchSteamStats();
